\begin{definition}[color checking matrix]\label{def:color checking matrix}
  After assignings arcs to coordinates in $M^s$ and crossings to coordinates in $N^x$ it is possible to define a linear homomorphism $D\phi:M^s\to N^x$  as
  $$D\phi(m_1,...,m_s)=(\phi_\pm(\pi_{x_1}(m_1,...,m_s)), \phi_\pm(\pi_{x_2}(m_1,...,m_s)),...).$$
  Matrix that is created after choosing a basis for $M^s$ and $N^x$ will be called a \buff{color checking matrix}.
\end{definition}

Taking $\phi_\pm$ to be linear equations of form
\begin{align}\label{phi equations1}
\phi_+(u,i,o)=au+bi+co \\ 
\phi_-(u,i,o)=\alpha u+\beta i+\gamma o, \label{phi equations2}
\end{align}
where $u$, $i$ and $o$ correspond to arcs as seen in \cref{crossing_type} and all the coefficients are linear homomorphisms $M\to N$, we know that all the entries for the color checking matrix will be linear combinations of $a$, $b$, $c$, $\alpha$, $\beta$, $\gamma$. If $M$ has $n$ generators we chose to block the matrix $D\phi$ into $n\times n$ blocks.

\begin{proposition}
  Coloring $(m_1,...,m_s)\in M^s$ is admissible $\iff$ $(m_1,...,m_s)\in\ker D\phi$.
\end{proposition}

\begin{proof}\color{blue}
  We start by saying that 
  $$(m_1,..., m_s)\in\ker D\phi\iff [(\forall\;x_j\text{ crossing})\;\phi_\pm(\pi_{x_j}(m_1,..., m_s))=0].$$
  Which is to say that every coordinate of $D\phi(m_1,..., m_s)$ is zero. Proposition \cref{proposition male kernel kolorowania} says that it is equivalent with $(m_1,..., m_s)$ being an admissible coloring.
\end{proof}

The reasoning presented in \cref{homological coloring} points at determinant of the coloring matrix being an invariant as was the case for the Alexander matrix. However, at the very moment the color checking matrix is not a knot invariant nor is its determinant. Any module $\mathcal{C}$ and associated with it pair of homomorphisms $\phi$ does not necessarily yield a "nice" coloring. The following example justifies the necessity of imposing restrictions to which a coloring rule must conform in order to be considered in the latter part of this paper.

\begin{example}
  Consider a coloring of trefoil knot $3_1$ with $\Z$ over the ring $\Z$ with $\phi_\pm(u, i, o)=2u-i+o$. The color checking matrix of its diagram with $3$ crossings is
  \begin{center}
    \begin{tikzpicture}
      \begin{knot}[
        consider self intersections, 
        clip width = 20pt, 
        % draft mode=crossings, 
        flip crossing=2
        ] 
        \strand[->, thick] (90:2) to[out=0, in=-60, looseness=2]
        (210:2) to[out=120, in=60, looseness=2]
        (-30:2) to[out=-120, in=180, looseness=2] 
        (90:2);
      \end{knot}

      \node at (6, 0) {
        $\det
        \begin{bmatrix}
          2 & -1 & 1\\ 
          -1 & 1 & 2 \\ 
          1 & 2 & -1 
        \end{bmatrix}=-3
      $};
    \end{tikzpicture}
    \begin{tikzpicture}
      \begin{knot}[
        consider self intersections, 
        clip width = 20pt,
        %ignore endpoint intersections=false,
        % draft mode=crossings,
        % flip crossin=1,
        % flip crossing=2
        ] 
        \strand[<-, thick] (80:3) to[out=-100, in=30] 
        (90:2) to[out=-30, in=-60, looseness=2]
        (210:2) to[out=120, in=60, looseness=2]
        (-30:2) to[out=-120, in=210, looseness=2] 
        (90:2) to[out=150, in=-80] 
        (100:3) to[out=100, in=80, looseness=2] 
        (80:3);
      \end{knot}
      \fill[white] (90:2) circle (10pt);
      \draw[thick] ($(90:2)+({0.3*cos(210)}, {0.3*sin(210)})+(-0.02, -0.07)$) to[out=30, in=-120] ($(90:2) + ({0.3*cos(30}, {0.3*sin(30})+(0, 0.08)$);%(80:3);
      % \draw[->, thin] (90:2) to[out=-30, in=-60, loosenes=2] (210:2);
      \node at (6, 0) {$\det
          \begin{bmatrix}
            0 & 2 & 1 & -1 \\ 
            0 & -1 & 2 & 1 \\ 
            1 & 0 & -1 & 2\\ 
            1 & 1 & 0 & 0
          \end{bmatrix}=-8$
        };
    \end{tikzpicture}
  \end{center}
\end{example}

The most important condition that $\mathcal{C}_\pm$ must meet is to be two dimensional. This will allow for propagation of coloring, meaning that knowing colors of two segments creating a crossing the third one can be calculated from $\phi_\pm$.

The following diagram
% \begin{center}
% \begin{tikzcd}
%   M^2 & M^3\arrow[l, twoheadrightarrow] \arrow[r, hookleftarrow] & \mathcal{C}\arrow[ll, bend left=20, red, "\sim"]
% \end{tikzcd}
% \end{center}
\begin{center}
\begin{tikzcd}
  M^2 \arrow[r, hookrightarrow] \arrow[rr, bend right=20, red, "\sim" below] & M^3 \arrow[r, twoheadrightarrow] & \mathcal{C}
\end{tikzcd}
\end{center}
must commute, with the red arrow being
$$(u, i)\mapsto (u, i, \phi_\pm'(u, i))$$
where $\phi_\pm'$ calculates the "out" segment in admissible coloring of each crossing (compare \cref{crossing_type}). Using (\ref{phi equations1}) and (\ref{phi equations2}) we can take $c$ and $\gamma$ to be any invertible elements, i.e. $c=\gamma=-1$, to have 
$$\phi_+'(u,i)=au+bi$$
$$\phi_-'(u,i)=\alpha u+\beta i$$

Notice that now a diagram with all but one segments colored can be easily colored in its entirety, using $\phi_\pm'$ on the crossing where the remaining segment starts.

%it will be beneficial to demand that the red arrow is an isomorphism.
% \begin{enumerate}
%   \item To allow \emph{trivial colorings}, that is colorings in which every arc is assigned the same value it is necessary that
%     $$(\forall\;m\in M)\;\phi_\pm(m,m,m)=0.$$
%   \item To simplify operations of color checking matrices, if
%     $$\phi_+(u, i, o)=au+bi+co$$
%     $$\phi_-(u,i,o)=\alpha u+\beta i+\gamma o,$$
%     then we take $c$ and $\gamma$ to be invertible. For the sake of simplicity, take $c=\gamma=-1$.
%   \item The two variations of orientation of the first Reidemeister move, pictured in \cref{fig: ograniczanie phi reidemeister 1}, put the following constrictions on $a$, $b$ and $\alpha$, $\beta$:
%     $$\begin{cases}
%       a+b=1\\
%       \alpha+\beta=1
%     \end{cases}$$
%   \item Lastly, from the second Reidemeister move, pictured in \cref{fig: ograniczanie phi reidemeister}, one can gather that  
%     $$\begin{cases}
%       a+b\alpha=0\\ 
%       b\beta=1
%     \end{cases}$$
%     meaning that both $b$ and $\beta$ must be units.
% \end{enumerate}
% %
% \begin{figure}[h]\centering
%   \begin{tikzpicture}
%       \begin{knot}[
%         clip width=20pt, 
%         consider self intersections,
%         flip crossing=1
%         ]
%         \strand[thick, ->] (0, 0) to[out=90, in=-90] (0, 1) to[out=90, in=150] (1, 2.5) to[out=-30, in=90] (1.3, 2) to[out=-90, in=30] (1, 1.5) to[out=-150, in=-90] (0, 3) to[out=90, in=-90] (0, 4);
%
%         \strand[thick, ->] (3, 0)--(3, 4);
%
%       \end{knot}
%       \draw[dashed, <->] (1.5, 2)--(2.7, 2);
%
%       \node at (-.5, 2) {$+$};
%       \node at (-1.3, 3.7) {$(a+b)x $};
%       \node at (-.3, -.3) {$x$};
%       \node at (3.3, -.3) {$x$};
%     \begin{scope}[shift={(0, -6)}]
%       \begin{knot}[
%         clip width=20pt, 
%         consider self intersections
%         ]
%         \strand[thick, ->] (0, 0) to[out=90, in=-90] (0, 1) to[out=90, in=150] (1, 2.5) to[out=-30, in=90] (1.3, 2) to[out=-90, in=30] (1, 1.5) to[out=-150, in=-90] (0, 3) to[out=90, in=-90] (0, 4);
%
%         \strand[thick, ->] (3, 0)--(3, 4);
%
%       \end{knot}
%       \draw[dashed, <->] (1.5, 2)--(2.7, 2);
%       \node at (-.5, 2) {$-$};
%
%       \node at (-1.3, 3.7) {$(\alpha+\beta)x $};
%       \node at (-.3, -.3) {$x$};
%       \node at (3.3, -.3) {$x$};
%     \end{scope}
%   \end{tikzpicture}
%   \caption{The two variations of the first Reidemeister move in oriented diagrams. They suggest that $(a+b)=1$ and $(\alpha+\beta)=1$.\label{fig: ograniczanie phi reidemeister 1}}
% \end{figure}
%
% \begin{figure}[h]\centering
%   \begin{tikzpicture}
%     \begin{knot}[
%       clip width=20pt, 
%       flip crossing=1,
%       flip crossing=2
%       ]
%       \strand[thick, ->] (0,-1)--(0, 4);
%       \strand[thick, ->] (-1, -1) to[out=90, in=180+45] (-.8, 0) to[out=45, in=-90] (1, 1.5) to[out=90, in=-45] (-.8, 3) to[out=180-45, in=-90] (-1, 4);
%
%       \strand[thick, ->] (5, -1) -- (5, 4);
%       \strand[thick, ->] (6, -1) -- (6, 4);
%
%     \end{knot}
%     \draw[dashed, <->] (1.5, 1.5)--(4.5, 1.5);
%
%     \node at (-1.3, -.3) {$x$};
%     \node at (.3, -.3) {$y$};
%     \node[anchor=east] at (-.3, 1.5) {$\alpha x+\beta y$};
%     \node[anchor=west] at (.3, 3.7) {$(a+b\alpha) x+b\beta y$};
%
%     \node at (4.7, -.3) {$x$};
%     \node at (6.3, -.3) {$y$};
%
%   \end{tikzpicture}
%   \caption{Second Reidemeister move. It suggests that $(a+b\alpha)=0$ and $b\beta =1$.\label{fig: ograniczanie phi reidemeister}}
% \end{figure}
%
%
% \marginnote{jeszcze przemyśleć tekst}
% It is worth mentioning that examining the second Reidemeister move (\cref{fig: ograniczanie phi reidemeister}) with $\phi_\pm$ changed to $2\times 2$ matrices $A_\pm$, which take arcs entering a crossing as input and output the arcs leaving it, we can see that 
% $$A_+ A_-=\begin{bmatrix}0 & 1\\ b & a\end{bmatrix}\begin{bmatrix}\alpha & \beta \\ 1 & 0\end{bmatrix}=Id.$$
% This means that from homomorphism $\phi_+$ we are able to calculate $\phi_-$ and vice versa.
%
% The color checking matrix is not a knot invariant, despite the restrictions laid on $\phi$. Changing the number of crossings in a diagram will obviously create a different matrix for the same knot. We will thus proceed to define an equivalence relation on the set of all color checking matrices of a knot $K$.

% Let $R$ be a commutative ring, typically $\Z[\Z]$, and take $M,N$ to be two $R$-modules. Consider two module homomorphisms $\phi_+:M^3\to N$ and $\phi_-:M^3\to N$ such that
% $$(\forall\;x\in M)\;\phi_\pm(x,x,x)=0.$$ 
% This homomorphism will be used to determine whether or not a labelling of knot arcs constitutes a coloring or not.
%
% \medskip
%
%
% {\large\color{red}tak naprawdę wystarczy jeden homomorfizm $\phi$, ale nie wiem jeszcze jak to wyjaśnić beż zahaczania o linki lub warkocze}.
% %{\large\color{red}JAK WUTLUMACZYC, ZE NAPRAWDE TO WYSTARCZY JEDNA FUNKCJA, ALE TAK BEDZIE MI LATWIEJ W ZYCIU? BO JAK NARYSUJĘ DIAGRAM Z DWOMA SKRZYŻOWANIAMI JEDNO + A DRUGIE - I POŁĄCZĘ JAK PRZY WARKOCZE -> LINKI TO DOSTAJĘ LINKA Z 2 KOMPONENTAMI :V}
% % It might appear that in the case of oriented diagram two different functions $\phi$ are required. However, considering the following diagram
% % \begin{figure}[h]\centering 
% %   \begin{tikzpicture}
% %     \draw[->] (0,-0.5) to (0, -1) to [out=-90, in=90] (1, -3);
% %     \draw[->] (1, -3) to (1, -3.5) to[out=-90, in=90] (0, -5.5) to (0,-6);
% %
% %     \fill[white] (.5, -2) circle (6pt);
% %     \fill[white] (.5, -4.5) circle (6pt);
% %
% %     \draw[->] (1,-0.5) to (1, -1) to[out=-90, in=90] (0, -3);
% %     \draw[->] (0, -3) to (0, -3.5) to[out=-90, in=90] (1, -5.5) to (1, -6);
% %     \draw (1, -6) to [out=-90, in=-90] (3, -4) to[out=90, in=-90] (3, -2.5) to[out=90, in=90] (1, -.5);
% %
% %     \node at (1, -2) {$-$};
% %     \node at (1, -4.5) {$+$};
% %   \end{tikzpicture}
% %   \caption{Why only one function $\phi$ is required?\label{just_why_phi}}
% % \end{figure}
%
% \medskip
%
%
% The color checking matrix in itself is obviously not a knot invariant. However, we might define an equivalence relation on the set of all matrices $M^m\to N^n$, $m,n\in\N$, such that all the matrices which come from the same knot fall into the same equivalence class.
%

% V also demand that a trivial coloring (every arc is assigned the same element of $M$) is an admissible coloring.

% The color checking matrix is not a knot invariant. Changing the diagram with accordance to the Reidemeister moves might change the dimensions of the matrix. Thus, we need to define an equivalence relation on the set of all color checking matrices.

