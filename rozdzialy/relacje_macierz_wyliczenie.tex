\section{Relation on color checking matrices}

In order to ensure that all matrices that stem from the same knot are considered in one equivalence class we will look at how Reidemeister moves change the matrix. 

In this section we will always assume that the diagram labeled as $D$ has $s$ segments and $x$ crossings. This means that always 
$$D\phi:M^s \to N^x.$$
Furthermore, we will always put rows and columns corresponding to crossings and segments that are affected by the Reidemeister move as the last columns and rows of the matrix.

\subsection*{\centering R1}

\def\bracketL{[}
\def\bracketR{]}
\renewcommand{\figurename}{}
\captionsetup{labelformat=empty}

\begin{figure}[h!]\centering 
  \caption{\textbf{R1a}\label{R1a}}
  \medskip

  \begin{tikzpicture}
    \begin{knot}[
      consider self intersections,
      clip width=20pt,
      flip crossing=1
      ]
      \strand[->, thick] (0, -1.5) to [out=90, in=-90] 
        (0, -1) to[out=90, in=120] 
        (1, 0.5) to[out=-60, in=60] 
        (1, -0.5) to[out=-120, in=-90] 
        (0, 1) to[out=90, in=-90] (0, 1.5);

      \strand[->, thick] (-3, -1.5) -- (-3, 1.5);
    \end{knot}
    \node at (-.5, 0) {$+$};
    \node at (-3.5, -1.8) {$D$};
    \node at (1, -1.8) {$D'$};

    \node at (-3.5, 0) {$y_s$};
    \node at (-0.3, -1) {$x_s$};
    \node at (0.5, 0.9) {$x_{s+1}$};
  \end{tikzpicture}
\end{figure}

In oriented diagrams, there are four distinct Reidemeister moves \cite{ruchy_zorientowane}, the first one having to account for two types of crossing. We start with \textbf{R1a}, pictured in \cref{R1a}. Consider the two matrices 
$$D\phi:M^s\to N^x$$ 
$$D'\phi:M^{s+1}\to N^{x+1}.$$
Only two arcs change between the two, thus 
$$D\phi\restriction M^{s-1}=D'\phi\restriction M^{s-1}.$$
Furthermore, we want to assert that the two arcs $x_s$ and $x_{s+1}$, into which $y_s$ is split, are arranged in a $+$ type crossing. Thus, for all $x_s, x_{s+1}\in M$ we require that
$$\pi_{x+1}[D'\phi(0,..., x_s, x_{s+1})]=\phi_+(x_{s+1},x_s,x_{s+1}),$$
where $\pi_{x+1}$ is projection onto the last coordinate. 
Additionally, we want the column that represented contribution of the twisted arc in diagram $D$ to be the sum of two new arcs in $D'\phi$, meaning that for every $y_s\in M$:
$$(D\phi(0,..., y_s), 0)=D'\phi(0,..., y_s, y_s).$$

\begin{figure}[h!]\centering 
  \caption{\textbf{R1b}\label{R1b}}
  \medskip

  \begin{tikzpicture}
    \begin{knot}[
      consider self intersections,
      clip width=20pt
      ]
      \strand[->, thick] (0, -1.5) to [out=90, in=-90] 
        (0, -1) to[out=90, in=120] 
        (1, 0.5) to[out=-60, in=60] 
        (1, -0.5) to[out=-120, in=-90] 
        (0, 1) to[out=90, in=-90] (0, 1.5);

      \strand[->, thick] (-3, -1.5) -- (-3, 1.5);
    \end{knot}
    \node at (-.5, 0) {$-$};
    \node at (-3.5, -1.8) {$D$};
    \node at (1, -1.8) {$D'$};

    \node at (-3.5, 0) {$y_s$};
    \node at (-0.3, -1) {$x_s$};
    \node at (-0.5, 0.9) {$x_{s+1}$};
  \end{tikzpicture}

\end{figure}

The second type of \textbf{R1} is seen in \cref{R1b}. The relation for this move is almost the same as above. We start with two matrices
$$D\phi:M^s\to N^x$$
$$D'\phi:M^{s+1}\to N^{x+1}$$
that must agree on the arcs and crossings that are not changed between $D$ and $D'$:
$$D\phi\restriction M^{s-1}=D'\phi\restriction M^{s-1}.$$
The type of crossing into which an arc of $D$ is twisted in $D'$ is differented than in \textbf{R1a}, thus the second equality is slightly different: for all $x_s, x_{s+1}\in M$
$$\pi_{x+1}[D'\phi(0,..., x_s, x_{s+1})]=\phi_-(x_{s},x_s,x_{s+1}).$$
The last requirement is not changed from \textbf{R1a}, meaning that for all $y_s\in M$:
$$(D\phi(0,..., y_s), 0)=D'\phi(0,..., y_s, y_s).$$

\subsection*{\centering R2}

\begin{figure}[h!]\centering 
  \caption{\textbf{R2}\label{R2}}
  \medskip 

  \begin{tikzpicture}
    \begin{knot}[
      consider self intersections,
      clip width=20pt,
      % draft mode=crossings,
      flip crossing=1,
      flip crossing=2
      ]
      \strand[->, thick] (0.8, -2)--(.8, 2);
      \strand[->, thick] (-0.5, -2) to [out=90, in=-120] 
      (1.5, -.25) to[out=60, in=-60] 
      (1.5, .25) to[out=120, in=-90] (-.5, 2);

      \strand[->, thick] (-3, -1.5) -- (-3, 1.5);
      \strand[->, thick] (-4, -1.5)--(-4, 1.5);
    \end{knot}
    \node at (1, -1.1) {$-$};
    \node at (1, 1.1) {$+$}; 
    \node at (-4.5, -2.2) {$D$};
    \node at (1.5, -2.2) {$D'$};

    \node at (-4.6, 0) {$x_{s-1}$};
    \node at (-2.6, 0) {$x_s$};

    \node at (2.1, 0) {$x_{s-1}$};
    \node at (0.3, 0) {$x_{s+1}$}; 
    \node at (0.4, -1.8) {$x_s$};
    \node at (0.3, 1.8) {$x_{s+2}$};
  \end{tikzpicture}
\end{figure}

For this Reidemeinster move we start with matrices 
$$D\phi:M^s\to N^x$$
$$D'\phi:M^{s+2}\to N^{x+2}.$$
Only two segments of $D$ are manipulated, thus
$$D\phi\restriction M^{s-2}=D'\phi\restriction M^{s-2}.$$
To ensure that the poke contributes adequate crossings, we want for every $x,y\in M$
\begin{align*}
  &D'\phi(0,..., x,y,y,y)=\\
  =&(D\phi(0,..., x,y), \phi_-(x,y,y), \phi_+(x,y,y))
\end{align*}

\subsection*{\centering R3}

\begin{figure}[h!]\centering 
  \caption{\textbf{R3}\label{R3}}
  \medskip 

  \begin{tikzpicture}
    \begin{knot}[
      consider self intersections,
      clip width=20pt,
      %draft mode=crossings,
      ignore endpoint intersections=false,
      flip crossing=1,
      flip crossing=2,
      flip crossing=3,
      flip crossing=4,
      flip crossing=5,
      flip crossing=6
      ]
      \strand[->, thick] (0, 0) to [out=45, in=-180+45] (4, 4);
      \strand[<-, thick] (4, 0) to [out=180-45, in=-45] (0, 4);
      \strand[<-, thick] (0, 1) -- (4, 1);

      \strand[->, thick] (6, 0) to [out=45, in=-180+45] (10, 4);
      \strand[<-, thick] (10, 0) to [out=180-45, in=-45] (6, 4);
      \strand[<-, thick] (6, 3) -- (10, 3);
    \end{knot}
    \node at (-0.5, -.2) {$D$};
    \node at (10.5, -.2) {$D'$};

    \node at (2, 2.35) {$-$};
    \node at (1, 0.65) {$+$};
    \node at (3, 1.35) {$-$};

    \node at (2, 0.65) {$x_{s-5}$};
    \node at (1, 3.65) {$x_{s}$};
    \node at (3, 3.65) {$x_{s-1}$};
    \node at (1, 1.65) {$x_{s-2}$};
    \node at (-0.3, 0.35) {$x_{s-3}$};
    \node at (4.3, 0.35) {$x_{s-4}$};

    \node at (8, 1.65) {$-$};
    \node at (9, 3.35) {$+$};
    \node at (7, 2.65) {$-$};

    \node at (2+6, 3.35) {$x_{s-5}$};
    \node at (6, 3.65) {$x_{s}$};
    \node at (10.5, 3.65) {$x_{s-1}$};
    \node at (9.2, 2.15) {$x_{s-2}$};
    \node at (6.5, 1.35) {$x_{s-3}$};
    \node at (4.1+6, 0.55) {$x_{s-4}$};
  \end{tikzpicture}
\end{figure}

$$D\phi\sim D'\phi$$
$$\text{if and only if}$$
\marginnote{WRÓCIĆ I DOPISAĆ?} %TO DO
\begin{align*}
  &D\phi\restriction M^{s-5}=D'\phi\restriction M^{s-5}\land \\ 
  \land & (\forall\;x,y,z\in M) \pi_{x-3}[D\phi(0,...,x,y,z)]=\\ 
        &= \pi_{x-3}[D'\phi(0,...,z,x,y,0,0)]\land \\ 
  \land & D\phi(0,...., z,y,0,0,0,x)=D'\phi(0,...,z,y,0,0,0,x)\land \\ 
  \land & D\phi(0,...,z,0,y,x,0,0) = D'\phi(0,...,z,0,0,y,x,0)
\end{align*}


\begin{theorem}
  Let $K$ be a knot and $D$ its oriented diagram. Define 
  $$K\phi:=[D\phi]$$
  to be the equivalence class of the matrix $D\phi$. Then, $K\phi$ is a knot invariant.
\end{theorem}

\begin{proof}
  An immediate result of construction presented above.\marginnote{brzydko brzmi}% TO DO
\end{proof}

\renewcommand{\figurename}{Figure}
\captionsetup{labelformat=simple}
