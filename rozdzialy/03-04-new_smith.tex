The ring $R$ of palette $(R, M, \mathcal{C}_\pm)$ is not necessarily a PID ring, e.g. $\Z[\Z]$ ring of the Alexander palette has ideal $(2, t+1)$ which is not principal. However, usually one can find a PID ring $P$ with homomorphism $R\to P$ which creates a new palette $(P, M\otimes_R P, \mathcal{C}_\pm\otimes_R P)$ derived from $(R, M, \mathcal{C}_\pm)$. Matrices over PID rings have many interesting properties, like having a Smith normal form.

\begin{definition}[Smith normal form]
Take $A\in K\phi$ and consider it as an $s\times x$ matrix with terms in a $P$ by the procedure outlined above. Then there exist a $s\times s$ matrix $S$ and $x\times x$ matrix $T$ such that $SAT$ is of form
$$
\begin{bmatrix}
  a_1 & 0 & 0 & \hdots & 0 & \hdots & 0 \\ 
  0 & a_2 & 0\\ 
  0 & 0 & \ddots & & \vdots & & \vdots\\ 
  \vdots & & & a_r\\ 
  0 & & \hdots & & 0 & \hdots & 0 \\ 
  \vdots & & & & \vdots & & \vdots\\ 
  0 & & \hdots & & 0 & \hdots & 0
\end{bmatrix}
$$
where for every $i$ $a_i|a_{i+1}$. Such a matrix $SAT$ is called the \buff{Smith normal form} of matrix $A$.
\end{definition}

The following is an algorithm for computing the Smith normal form of a matrix $A$:

\begin{enumerate}
  \item Let $A=\{a_{i,j}\}_{i,j\leq n}$ be an $n\times n$ matrix. Take the ideal $I=(a_{i,j})_{0<i,j\leq n}$ generated by all the terms of $A$. 
  \item If we are in PID then $I$ has one generator, call it $a$.
  \item We can now use the following row and column operations to put $a$ in the upper left corner of $A$
    \begin{enumerate}
      \item Permuting rows (columns).
      \item Adding a linear combination of rows (columns) to the remaining row (column).
    \end{enumerate}
  \item With $a$ in the upper left corner we can now use the fact that it was the generator of $I$ to strike out the remaining terms on the first column and row, using the operations described in the previous point.
  \item Repeat the same algorithm on the smaller matrix  $\{a_{i,j}\}_{1<i, j\leq n}$.
\end{enumerate}

In \cref{admissible coloring is kernel} we showed that $\overline{x}\in M^n$ is an admissible coloring of a diagram $D$ if and only if $\overline{x}\in\ker D\phi$. The Smith normal form of $D\phi$, when the diagram is colored using the Alexander palette, hints at the structure of matrix kernel - the columns filled with zeros will contributed a factor $M$ to the kernel. 

Similarly, each column of the Smith normal form contains information about the cokernel $\coker(D\phi)$. The columns containing units disappear, the zero columns contribute a free factor while for every other term $a$ which appears on the diagonal, $P/(a)$ is a summand of the cokernel. In \cref{alexander matrix def} the $\coker(A_D)$ is equal to the Alexander module.


% Take $(a)$ to be a prime ideal with its generator $a$ appearing on the diagonal of the Smith normal form of $D\phi$. Then we might consider the matrix over a new ring $P/(a)$, which is still a PID. After this change, the structure of the kernel has changed as now there are additional zero columns where $a$ and all its multiples stood. Meaning that kernel became bigger and more colorings are admissible over $P/(a)$. 


\begin{definition}[reduced normal form of matrix]\label{reduced normal form def}
  Take $A$ to be a matrix with coefficients in principal ideal domain $P$. Take $a_1,...,a_k\in P$ to be all the elements of the Smith normal form of $A$ that are neither zero nor invertible. Consider a new square matrix 
  $$
  \begin{bmatrix}
    a_1 & 0 & 0 & \hdots & 0\\ 
    0 & a_2 & 0 & \hdots & 0 \\ 
    0 & 0 & \ddots & &  \\ 
    \vdots & \vdots & & & \vdots \\ 
    0 & 0 & \hdots & 0 & a_k
  \end{bmatrix}
  $$
  which will be called the \buff{reduced normal form} of matrix $A$.
\end{definition}

Consider the following as a motivation behind \cref{reduced normal form def}.

\begin{example} \label{example reduced normal form}
  \begin{figure}[h]\centering 
    \begin{tikzpicture}
      \coordinate (a1) at (90:6);
      \coordinate (a2) at (0: 2);
      \coordinate (a3) at ($(-90:5.5)+(4, 0)$);
      \coordinate (a4) at (-80:2);
      \coordinate (a5) at (-90:5.5);
      \coordinate (a6) at (-10:5);
      \coordinate (a7) at (30:7);
      \coordinate (a8) at (180:2.5);
      \coordinate (a9) at (-90:3.5);
      \coordinate (a10) at (-10:7);
      \coordinate (a11) at (110:2);

      % \foreach \i in {1,..., 11} \fill (a\i) circle (5pt);

      \begin{knot}[
        consider self intersections, 
        clip width = 20pt,
        % draft mode=crossings, 
        ignore endpoint intersections=false,
        flip crossing=1, 
        flip crossing=3,
        flip crossing=4, 
        flip crossing=5, 
        flip crossing=7, 
        flip crossing=11, 
        flip crossing=12, 
        flip crossing=9
        ]
        \strand[thick] (a1) to[out=-30, in=90] 
        (a2) to[out=-90, in=200] 
        (a3) to[out=20, in=0, looseness=2]
        (a4) to[out=180, in=180, looseness=2] 
        (a5) to[out=0, in=-100] 
        (a6) to[out=80, in=-60] 
        (a7) to[out=120, in=90]
        (a8) to[out=-90, in=180] 
        (a9) to[out=0, in=-90, looseness=2] 
        (a10) to[out=90, in=0]
        (a11) to[out=180, in=150, looseness=1.5]
        (a1);
      \end{knot}
    \end{tikzpicture}
    \caption{A diagram for knot $K11n85$.\label{k11n85 diagram}}
  \end{figure}

  \begin{figure}[h]\centering 
    \begin{tikzpicture}
      \coordinate (a1) at (90:5);
      \coordinate (a2) at (40:3);
      \coordinate (a3) at (-40:3);
      \coordinate (a4) at (-90:5);
      \coordinate (a5) at (-160:3.5);
      \coordinate (a6) at (40:1);
      \coordinate (a7) at (20:6);
      \coordinate (a8) at (80:3);
      \coordinate (a9) at (180+25:1);
      \coordinate (a10) at (130:4);
      \coordinate (a11) at (180:5);
      \coordinate (a12) at (-90:3);
      \coordinate (a13) at (-10:6);
      \coordinate (a14) at (110:2);
      \coordinate (a15) at (110:5);

      % \foreach \i in {1,..., 15} \fill (a\i) circle (5pt);

      \begin{knot}[
        consider self intersections, 
        clip width = 20pt, 
        % draft mode=crossings, 
        flip crossing=1, 
        flip crossing=3, 
        flip crossing=8, 
        flip crossing=4, 
        flip crossing=7, 
        flip crossing=10, 
        flip crossing=9
        ]
        \strand[thick] (a1) to[out=0, in=90] 
        (a2) to[out=-90, in=90] 
        (a3) to[out=-90, in=0] 
        (a4) to[out=180, in=-120]
        (a5) to[out=60, in=150]
        (a6) to[out=-30, in=-90] 
        (a7) to[out=90, in=90, looseness=2] 
        (a8) to[out=-90, in=30]
        (a9) to[out=-150, in=-60]
        (a10) to[out=120, in=90] 
        (a11) to[out=-90, in=180]
        (a12) to[out=0, in=-90] 
        (a13) to[out=90, in=20, looseness=1.5]
        (a14) to[out=-160, in=200, looseness=2]
        (a15) to[out=20, in=180] 
        (a1);
      \end{knot}
    \end{tikzpicture}
    \caption{A diagram for knot $K11n164$.\label{k11n164 diagram}}
  \end{figure}
  Consider the knots $K11n85$ and $K11n164$ pictured in \cref{k11n85 diagram,k11n164 diagram} respectively. They both have the Alexander polynomial equal 
  $$
  \Delta(t)=-t^3+5t^2-10t+13-10t^{-1}+5t^{-2}-t^{-3}.
  $$
  Coloring them with the Alexander palette
  yields two $11\times 11$ matrices whose any $10\times 10$ minor is equal to the Alexander polynomial (up to multiplication by a unit). However, the reduced Smith normal forms are distinguishable
  $$D_{11n85}\phi=\begin{bmatrix}
    -t^3+5t^2-10t+13-10t^{-1}+5t^{-2}-t^{-3}
  \end{bmatrix}$$
  $$
  D_{11n164}\phi=\begin{bmatrix}
    1-t+t^2 & 0 \\ 
    0 & -t^{-1}+4-5t+4t^2-t^3
  \end{bmatrix}
  $$
\end{example}
 
\input{./rozdzialy/theorem_reduced_normal_is_invariant.tex}
